.container-fluid.pad-edge
  %h1.pt-5
    - if not params[:search_term].blank? 
      Listing products related to 
      = "'" + @query["search_term"] + "'"
    - else 
      Product Archive

  .d-flex
    .me-auto
      %h2
        = page_entries_info products, :model => 'product'
    Filters
    -# = form_with url: products_path, method: :get do |form|
    -#   .input-group
    -#     .form-outline

    -#       = form.select(:business_id) do
    -#         - @business.each do |business|
    -#           = content_tag(:option, business.name, value: business.id)
    -#     = form.button :Apply, name: 'Submit', value: 'Apply', class: 'btn btn-outline-primary'


  - if products.size > 0
    %table.table
      %thead
        %tr
          %th Name
          %th Description
          %th Vendor
          %th Mass
          %th Category
          %th Url
          %th Manufacturer
          %th Manufacturer country
          %th Co2 produced
          %th Materials
          %th
          %th
          %th

      %tbody
        - products.each do |product| 
          %tr
            %td= product.name
            %td= product.description
            %td= product.business_name
            %td= product.mass
            %td= product.category
            %td= product.url
            %td= product.manufacturer
            %td= product.manufacturer_country
            %td= product.co2_produced
            %td
              - product.materials.each do |material|
                %br= material.name
                //%td= material[1]
            %td= link_to 'Show', product
            - if can?(:edit, Product)
              %td= link_to 'Edit', edit_product_path(product)
            - if can?(:delete, Product)
              %td= link_to 'Destroy', product, :method => :delete, :data => { :confirm => 'Are you sure?' }

  %br

  .justify-content-center.pagination
    = will_paginate(products, :renderer => WillPaginate::ActionView::Bootstrap4LinkRenderer)


  - if can?(:new, Product)
    = link_to 'New Product', new_product_path
